// File: text_processor.ruchy
// Processes text files with various operations

println("=== Text Processor ===")
let filename = input("Enter filename: ")

if !file_exists(filename) {
    println(f"Error: File '{filename}' not found!")
    exit(1)
}

let content = read_file(filename)
let lines = content.lines()

println("\nChoose operation:")
println("1. Count lines")
println("2. Find and replace")
println("3. Convert to uppercase") 
println("4. Remove empty lines")

let choice = input("Enter choice (1-4): ").to_i()

match choice {
    1 => {
        println(f"Total lines: {lines.len()}")
    }
    2 => {
        let find = input("Find: ")
        let replace = input("Replace with: ")
        let new_content = content.replace(find, replace)
        let output_file = filename.replace(".txt", "_modified.txt")
        write_file(output_file, new_content)
        println(f"Saved to: {output_file}")
    }
    3 => {
        let upper_content = content.to_uppercase()
        let output_file = filename.replace(".txt", "_upper.txt")
        write_file(output_file, upper_content)
        println(f"Saved to: {output_file}")
    }
    4 => {
        let clean_lines = lines.filter(|line| !line.trim().is_empty())
        let clean_content = clean_lines.join("\n")
        let output_file = filename.replace(".txt", "_clean.txt")
        write_file(output_file, clean_content)
        println(f"Saved to: {output_file}")
    }
    _ => {
        println("Invalid choice!")
    }
}