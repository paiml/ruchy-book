<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Testing Functions - The Ruchy Programming Language</title>


        <!-- Custom HTML head -->

        <meta name="description" content="The official book for the Ruchy language - implementation-first documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "rust";
            const default_dark_theme = "coal";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Ruchy Programming Language</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/paiml/ruchy-book" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/paiml/ruchy-book/edit/main/src/ch03-01-testing-functions.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="testing-functions"><a class="header" href="#testing-functions">Testing Functions</a></h1>
<p><em>“I used to think testing was extra work that slowed me down. Then I spent three days debugging a function that had a one-line bug I could have caught with a 30-second test. Now I write tests first - they’re my safety net and my specification all in one.”</em> - Noah Gift</p>
<h2 id="the-problem"><a class="header" href="#the-problem">The Problem</a></h2>
<p>You’ve written some great functions, but how do you know they actually work? How do you catch bugs before your users do? How do you make sure changes don’t break existing functionality?</p>
<p>Manual testing means running your code, checking output, and hoping you didn’t miss anything. In professional development, this doesn’t scale. You need automated tests that run every time, catch problems immediately, and give you confidence to make changes.</p>
<h2 id="quick-example"><a class="header" href="#quick-example">Quick Example</a></h2>
<p>Here’s how you test functions in Ruchy:</p>
<pre><code class="language-ruchy">// Your function
fn add(a, b) {
    return a + b
}

// Your test
#[test]
fn test_add() {
    assert_eq!(add(2, 3), 5)
    assert_eq!(add(0, 0), 0)
    assert_eq!(add(-1, 1), 0)
}
</code></pre>
<p>Run it:</p>
<pre><code class="language-bash">$ ruchy test
Running 1 test...
test_add ... PASS
✅ All tests passed!
</code></pre>
<p>That’s it! Write tests, run tests, ship with confidence.</p>
<h2 id="core-concepts"><a class="header" href="#core-concepts">Core Concepts</a></h2>
<h3 id="test-functions"><a class="header" href="#test-functions">Test Functions</a></h3>
<p>Test functions in Ruchy use the <code>#[test]</code> attribute:</p>
<pre><code class="language-ruchy">#[test]
fn test_function_name() {
    // Test code here
    assert_eq!(actual, expected)
}
</code></pre>
<ul>
<li><code>#[test]</code> marks the function as a test</li>
<li>Test functions take no parameters</li>
<li>Use <code>assert_eq!</code> to check if values match</li>
<li>Test function names should describe what they test</li>
</ul>
<h3 id="assertions"><a class="header" href="#assertions">Assertions</a></h3>
<p>Ruchy provides several assertion macros:</p>
<ul>
<li><code>assert_eq!(actual, expected)</code> - values must be equal</li>
<li><code>assert!(condition)</code> - condition must be true</li>
<li><code>assert_ne!(actual, expected)</code> - values must NOT be equal</li>
</ul>
<h3 id="test-organization"><a class="header" href="#test-organization">Test Organization</a></h3>
<pre><code class="language-ruchy">// tests/calculator_test.ruchy

use super::*;  // Import functions from main module

#[test]
fn test_addition() {
    assert_eq!(add(2, 3), 5)
}

#[test]  
fn test_subtraction() {
    assert_eq!(subtract(10, 4), 6)
}
</code></pre>
<h2 id="practical-testing-patterns"><a class="header" href="#practical-testing-patterns">Practical Testing Patterns</a></h2>
<h3 id="testing-pure-functions"><a class="header" href="#testing-pure-functions">Testing Pure Functions</a></h3>
<p>Pure functions are easiest to test - same input, same output:</p>
<pre><code class="language-ruchy">// calculator.ruchy
fn multiply(a, b) {
    return a * b
}

fn divide(a, b) {
    if b == 0 {
        return None
    }
    return Some(a / b)
}

fn is_even(n) {
    return n % 2 == 0
}

// tests/calculator_test.ruchy  
#[test]
fn test_multiply() {
    assert_eq!(multiply(3, 4), 12)
    assert_eq!(multiply(0, 5), 0)
    assert_eq!(multiply(-2, 3), -6)
}

#[test]
fn test_divide() {
    assert_eq!(divide(10, 2), Some(5))
    assert_eq!(divide(7, 3), Some(2))  // Integer division
    assert_eq!(divide(5, 0), None)     // Division by zero
}

#[test]
fn test_is_even() {
    assert!(is_even(4))        // 4 is even
    assert!(!is_even(3))       // 3 is not even  
    assert!(is_even(0))        // 0 is even
    assert!(!is_even(-1))      // -1 is not even
}
</code></pre>
<h3 id="testing-edge-cases"><a class="header" href="#testing-edge-cases">Testing Edge Cases</a></h3>
<p>Good tests cover normal cases AND edge cases:</p>
<pre><code class="language-ruchy">fn find_max(numbers) {
    if numbers.is_empty() {
        return None
    }
    
    let max_val = numbers[0]
    for num in numbers {
        if num &gt; max_val {
            max_val = num
        }
    }
    return Some(max_val)
}

#[test]
fn test_find_max() {
    // Normal cases
    assert_eq!(find_max([1, 5, 3, 9, 2]), Some(9))
    assert_eq!(find_max([10]), Some(10))
    
    // Edge cases
    assert_eq!(find_max([]), None)           // Empty list
    assert_eq!(find_max([-5, -1, -10]), Some(-1))  // All negative
    assert_eq!(find_max([5, 5, 5]), Some(5))       // All same
}
</code></pre>
<h3 id="testing-text-functions"><a class="header" href="#testing-text-functions">Testing Text Functions</a></h3>
<pre><code class="language-ruchy">fn clean_username(raw_username) {
    return raw_username.trim().lower().replace(" ", "_")
}

fn count_vowels(text) {
    let vowels = "aeiou"
    let count = 0
    for char in text.lower().chars() {
        if vowels.contains(char) {
            count = count + 1
        }
    }
    return count
}

#[test]
fn test_clean_username() {
    assert_eq!(clean_username("  Alice Johnson  "), "alice_johnson")
    assert_eq!(clean_username("JOHN"), "john")
    assert_eq!(clean_username(""), "")
}

#[test]
fn test_count_vowels() {
    assert_eq!(count_vowels("hello"), 2)      // e, o
    assert_eq!(count_vowels("HELLO"), 2)      // Case insensitive
    assert_eq!(count_vowels("xyz"), 0)        // No vowels
    assert_eq!(count_vowels("aeiou"), 5)      // All vowels
    assert_eq!(count_vowels(""), 0)           // Empty string
}
</code></pre>
<h3 id="testing-business-logic"><a class="header" href="#testing-business-logic">Testing Business Logic</a></h3>
<pre><code class="language-ruchy">fn calculate_grade(score) {
    if score &gt;= 90 { return "A" }
    if score &gt;= 80 { return "B" } 
    if score &gt;= 70 { return "C" }
    if score &gt;= 60 { return "D" }
    return "F"
}

fn can_vote(age, is_citizen) {
    return age &gt;= 18 &amp;&amp; is_citizen
}

#[test]
fn test_calculate_grade() {
    // Boundary testing
    assert_eq!(calculate_grade(95), "A")
    assert_eq!(calculate_grade(90), "A")  // Exactly 90
    assert_eq!(calculate_grade(89), "B")  // Just below A
    assert_eq!(calculate_grade(80), "B")  // Exactly 80
    assert_eq!(calculate_grade(79), "C")  // Just below B
    assert_eq!(calculate_grade(59), "F")  // Failing grade
    assert_eq!(calculate_grade(0), "F")   // Very low
}

#[test]
fn test_can_vote() {
    // All combinations
    assert!(can_vote(18, true))      // Minimum age, citizen
    assert!(can_vote(25, true))      // Adult citizen
    assert!(!can_vote(17, true))     // Too young
    assert!(!can_vote(25, false))    // Not citizen
    assert!(!can_vote(17, false))    // Too young AND not citizen
}
</code></pre>
<h2 id="test-driven-development-tdd"><a class="header" href="#test-driven-development-tdd">Test-Driven Development (TDD)</a></h2>
<p>Write tests BEFORE you write code:</p>
<ol>
<li><strong>Write a failing test</strong> (Red)</li>
<li><strong>Write minimal code to pass</strong> (Green)</li>
<li><strong>Refactor and improve</strong> (Refactor)</li>
</ol>
<pre><code class="language-ruchy">// Step 1: Write the test first
#[test]
fn test_fahrenheit_to_celsius() {
    assert_eq!(fahrenheit_to_celsius(32), 0)    // Freezing point
    assert_eq!(fahrenheit_to_celsius(212), 100) // Boiling point
    assert_eq!(fahrenheit_to_celsius(98.6), 37) // Body temperature
}

// Step 2: Write minimal code to pass
fn fahrenheit_to_celsius(fahrenheit) {
    return (fahrenheit - 32) * 5 / 9
}

// Step 3: Run tests, refactor if needed
// All tests pass! Code is ready to use.
</code></pre>
<h2 id="common-testing-mistakes"><a class="header" href="#common-testing-mistakes">Common Testing Mistakes</a></h2>
<h3 id="not-testing-edge-cases"><a class="header" href="#not-testing-edge-cases">Not Testing Edge Cases</a></h3>
<pre><code class="language-ruchy">// ❌ Only testing happy path
#[test]
fn test_divide_bad() {
    assert_eq!(divide(10, 2), 5)  // What about divide by zero?
}

// ✅ Testing edge cases
#[test]
fn test_divide_good() {
    assert_eq!(divide(10, 2), 5)      // Normal case
    assert_eq!(divide(0, 5), 0)       // Zero dividend
    // Should handle divide by zero gracefully
}
</code></pre>
<h3 id="tests-that-dont-actually-test"><a class="header" href="#tests-that-dont-actually-test">Tests That Don’t Actually Test</a></h3>
<pre><code class="language-ruchy">// ❌ This test will always pass
#[test]
fn test_useless() {
    let result = add(2, 3)
    assert!(result &gt; 0)  // Too vague!
}

// ✅ This test verifies exact behavior
#[test]  
fn test_useful() {
    assert_eq!(add(2, 3), 5)  // Exact expectation
}
</code></pre>
<h3 id="poor-test-names"><a class="header" href="#poor-test-names">Poor Test Names</a></h3>
<pre><code class="language-ruchy">// ❌ Unclear what this tests
#[test]
fn test1() {
    assert_eq!(is_valid("abc"), false)
}

// ✅ Clear, descriptive name
#[test]
fn test_password_too_short() {
    assert_eq!(is_valid_password("abc"), false)
}
</code></pre>
<h2 id="try-it-yourself"><a class="header" href="#try-it-yourself">Try It Yourself</a></h2>
<p>Time to become a testing expert! Test-drive some functions:</p>
<pre><code class="language-bash">$ ruchy repl
&gt;&gt;&gt; # Start with a simple function and test
&gt;&gt;&gt; fn double(x) { return x * 2 }
&gt;&gt;&gt; 
&gt;&gt;&gt; # Test it immediately
&gt;&gt;&gt; assert_eq!(double(5), 10)
&gt;&gt;&gt; assert_eq!(double(0), 0)
&gt;&gt;&gt; assert_eq!(double(-3), -6)
&gt;&gt;&gt; 
&gt;&gt;&gt; println("All double() tests pass!")
</code></pre>
<p><strong>Your Testing Challenges:</strong></p>
<ol>
<li>
<p><strong>Test Your Previous Functions</strong>: Go back to functions you created earlier and write comprehensive tests</p>
</li>
<li>
<p><strong>TDD Practice</strong>: Use test-driven development to create:</p>
<ul>
<li>Password strength validator</li>
<li>Email format checker</li>
<li>Age category classifier (child/teen/adult/senior)</li>
</ul>
</li>
<li>
<p><strong>Edge Case Hunter</strong>: For each function, identify and test:</p>
<ul>
<li>Empty inputs</li>
<li>Boundary values</li>
<li>Invalid inputs</li>
<li>Extreme values</li>
</ul>
</li>
<li>
<p><strong>Business Logic Testing</strong>: Create and test functions for:</p>
<ul>
<li>Shipping cost calculator</li>
<li>Tax calculator</li>
<li>Discount eligibility checker</li>
</ul>
</li>
</ol>
<p><strong>Example TDD Session:</strong></p>
<pre><code class="language-ruchy">// 1. Write failing tests first
#[test]
fn test_is_strong_password() {
    assert!(is_strong_password("MyPass123!"))      // Valid
    assert!(!is_strong_password("weak"))           // Too short
    assert!(!is_strong_password("NoNumbers!"))     // No digits
    assert!(!is_strong_password("nonumbers123"))   // No special chars
}

// 2. Write minimal code to pass
fn is_strong_password(password) {
    if password.len() &lt; 8 { return false }
    
    let has_digit = password.chars().any(|c| c.is_digit())
    let has_special = password.chars().any(|c| "!@#$%^&amp;*".contains(c))
    
    return has_digit &amp;&amp; has_special
}

// 3. Run tests - they should all pass now!

// 4. Add more edge case tests
#[test]
fn test_password_edge_cases() {
    assert!(!is_strong_password(""))              // Empty
    assert!(!is_strong_password("12345678"))      // Only digits
    assert!(!is_strong_password("!!!!!!!!"))      // Only special
}
</code></pre>
<p>Testing is your superpower - use it to build software with confidence!</p>
<h2 id="summary"><a class="header" href="#summary">Summary</a></h2>
<ul>
<li>Use <code>#[test]</code> to mark test functions</li>
<li><code>assert_eq!</code> checks if values match exactly</li>
<li>Test normal cases AND edge cases</li>
<li>Write descriptive test names</li>
<li>Test-driven development: test first, then code</li>
<li>Good tests are your safety net for changes</li>
<li>Every function should have at least one test</li>
<li>Testing catches bugs before users find them</li>
</ul>
<p>You now have the tools to write reliable, tested code! Next, let’s learn how to build complete applications using these foundational skills.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch03-00-functions.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch04-00-command-line-tools.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch03-00-functions.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch04-00-command-line-tools.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="mode-rust.js"></script>
        <script src="editor.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
